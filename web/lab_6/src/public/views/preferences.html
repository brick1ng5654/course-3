<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        .preferences-container {
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .color-sample {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid #ddd;
            margin-left: 10px;
            vertical-align: middle;
        }
        .session-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .nav-buttons {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            color: white;
            cursor: pointer;
            display: inline-block;
            text-align: center;
            font-size: 14px;
        }
        .btn-primary { background: #3498db; }
        .btn-secondary { background: #27ae60; }
        .btn-danger { background: #e74c3c; }
        .btn-outline { 
            background: transparent; 
            border: 2px solid #3498db; 
            color: #3498db;
        }
        .current-settings {
            margin-top: 20px;
            padding: 15px;
            background: #e8f5e8;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="preferences-container">
            <h1>üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
            
            <div class="session-info">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Å—Å–∏–∏:</h3>
                <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—â–µ–Ω–∏–π: <strong id="visitCount">0</strong></p>
                <p>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ—Å–µ—â–µ–Ω–∏–µ: <strong id="lastVisit">-</strong></p>
            </div>

            <form action="/save-preferences" method="POST">
                <div class="form-group">
                    <label for="userName">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" id="userName" name="userName" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                </div>

                <div class="form-group">
                    <label for="bgColor">–¶–≤–µ—Ç —Ñ–æ–Ω–∞:</label>
                    <input type="color" id="bgColor" name="bgColor" class="form-control" value="#ffffff">
                    <span class="color-sample" id="colorPreview"></span>
                </div>

                <div class="nav-buttons">
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                    <a href="/profile" class="btn btn-secondary">–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å</a>
                    <a href="/clear-cookies" class="btn btn-danger">–û—á–∏—Å—Ç–∏—Ç—å Cookie</a>
                    <a href="/" class="btn btn-outline">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
                </div>
            </form>

            <div class="current-settings" id="currentSettings" style="display: none;">
                <h4>–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:</h4>
                <p>–ò–º—è: <strong id="currentName">-</strong></p>
                <p>–¶–≤–µ—Ç —Ñ–æ–Ω–∞: <span class="color-sample" id="currentColor"></span> <code id="currentColorCode">-</code></p>
            </div>
        </div>
    </div>

    <script>
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            loadUserPreferences();
        });

        // Live preview —Ü–≤–µ—Ç–∞
        document.getElementById('bgColor').addEventListener('input', function(e) {
            document.body.style.backgroundColor = e.target.value;
            document.getElementById('colorPreview').style.backgroundColor = e.target.value;
        });

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function loadUserPreferences() {
            // –ü–æ–ª—É—á–∞–µ–º cookies
            const cookies = document.cookie.split(';').reduce((acc, cookie) => {
                const [key, value] = cookie.trim().split('=');
                acc[key] = value;
                return acc;
            }, {});

            const userName = cookies.userName || '';
            const bgColor = cookies.bgColor || '#ffffff';
            const visitCount = cookies.visitCount || '0';
            const lastVisit = cookies.lastVisit || '-';

            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
            if (userName) {
                document.getElementById('userName').value = userName;
                document.getElementById('currentName').textContent = userName;
                document.getElementById('currentSettings').style.display = 'block';
            }

            if (bgColor) {
                document.getElementById('bgColor').value = bgColor;
                document.body.style.backgroundColor = bgColor;
                document.getElementById('colorPreview').style.backgroundColor = bgColor;
                document.getElementById('currentColor').style.backgroundColor = bgColor;
                document.getElementById('currentColorCode').textContent = bgColor;
            }

            // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏
            document.getElementById('visitCount').textContent = visitCount;
            document.getElementById('lastVisit').textContent = lastVisit;
        }
    </script>
</body>
</html>